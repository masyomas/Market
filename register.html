<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ“ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØ§Ù„Ø¯Ø®ÙˆÙ„</title>
<style>
body { font-family:'Tahoma',sans-serif; margin:0; padding:0; text-align:center; background:#fff;}
header { background:#6c757d; color:#fff; padding:15px; font-size:22px;}
section { margin:10px auto; width:95%; max-width:400px; border-bottom:1px solid #ddd; padding-bottom:10px;}
h3 { margin-top:10px; }
input { padding:6px; margin:4px auto; width:80%; max-width:250px;}
button { padding:6px 12px; margin:6px auto; font-size:14px; background:#6c757d; color:#fff; border:none; border-radius:4px; cursor:pointer;}
button:hover { background:#555;}
footer { background:#f1f1f1; text-align:center; padding:8px; font-size:13px; color:#777; border-top:1px solid #ddd;}
</style>
</head>
<body>

<header>ğŸ“ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØ§Ù„Ø¯Ø®ÙˆÙ„</header>

<section>
  <h3>âœ¨ ØªØ³Ø¬ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯</h3>
  <input type="text" id="newName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ"><br/>
  <input type="text" id="newPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"><br/>
  <input type="number" id="newCode" placeholder="Ø§Ù„ÙƒÙˆØ¯ (2006 - 9998)"><br/>
  <button onclick="registerNewUser()">âœ… ØªØ³Ø¬ÙŠÙ„</button>
</section>

<section>
  <h3>ğŸ”‘ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
  <input type="text" id="phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„"><br/>
  <input type="number" id="code" placeholder="Ø§Ù„ÙƒÙˆØ¯"><br/>
  <button onclick="loginUser()">â¡ï¸ Ø¯Ø®ÙˆÙ„</button>
</section>

<footer>ğŸ’ Powered by Almasa ğŸ’</footer>

<script>
// Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„ Ù…Ø±Ø©
if(!localStorage.getItem('superAdmin')){
  localStorage.setItem('superAdmin', JSON.stringify({ phone:"01552402912", code:790707071 }));
}
let defaultAdmins = [
  {name:"admin1", phone:"01111111111", code:11111},
  {name:"admin2", phone:"01111111112", code:22222},
  {name:"admin3", phone:"01111111113", code:33333},
  {name:"admin4", phone:"01111111114", code:44444},
  {name:"admin5", phone:"01111111115", code:55555}
];
if(!localStorage.getItem('admins')){
  localStorage.setItem('admins', JSON.stringify(defaultAdmins));
}

// ØªØ³Ø¬ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
function registerNewUser(){
  let name=document.getElementById('newName').value.trim();
  let phone=document.getElementById('newPhone').value.trim();
  let code=parseInt(document.getElementById('newCode').value.trim());
  let users=JSON.parse(localStorage.getItem('users')||"[]");

  if(!/^[\u0600-\u06FF\s]+$/.test(name) || name.split(' ').length<3){
    alert("âš ï¸ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ Ø¨Ø­Ø±ÙˆÙ Ø¹Ø±Ø¨ÙŠØ© ÙÙ‚Ø·"); return;
  }
  if(!/^0\d{10}$/.test(phone)){ alert("âš ï¸ Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù…ÙˆØ¨Ø§ÙŠÙ„ ØµØ­ÙŠØ­ ÙŠØ¨Ø¯Ø£ Ø¨Ù€0 ÙˆÙŠØªÙƒÙˆÙ† Ù…Ù† 11 Ø±Ù‚Ù…"); return; }
  if(isNaN(code)||code<2006||code>9998){ alert("âš ï¸ Ø§Ù„ÙƒÙˆØ¯ Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Ø·Ø§Ù‚"); return; }
  if(users.find(u=>u.code===code)){ alert("âš ï¸ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø³ØªØ®Ø¯Ù…"); return; }
  if(users.find(u=>u.phone===phone)){ alert("âš ï¸ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù…"); return; }
  if(users.find(u=>u.name===name)){ alert("âš ï¸ Ø§Ù„Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù…"); return; }

  users.push({name, phone, code});
  localStorage.setItem('users', JSON.stringify(users));
  alert("âœ… ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­! ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¢Ù†");
}

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
function loginUser(){
  let phone=document.getElementById('phone').value.trim();
  let code=parseInt(document.getElementById('code').value.trim());
  if(!phone||isNaN(code)){ alert("âš ï¸ Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ ÙˆØ§Ù„ÙƒÙˆØ¯"); return; }

  let superAdmin=JSON.parse(localStorage.getItem('superAdmin'));
  let admins=JSON.parse(localStorage.getItem('admins')||"[]");
  let users=JSON.parse(localStorage.getItem('users')||"[]");

  if(phone===superAdmin.phone && code===superAdmin.code){
    localStorage.setItem('loggedUser', JSON.stringify({role:"super", phone, code}));
    location.href="admin.html";
  }
  else if(admins.find(a=>a.phone===phone && a.code===code)){
    localStorage.setItem('loggedUser', JSON.stringify({role:"admin", phone, code}));
    location.href="admin.html";
  }
  else if(users.find(u=>u.phone===phone && u.code===code)){
    localStorage.setItem('loggedUser', JSON.stringify({role:"user", phone, code}));
    location.href="myPurchases.html";
  }
  else{
    alert("âš ï¸ Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø© Ø£Ùˆ Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„");
  }
}

// Ù…Ù†Ø¹ Ø¸Ù‡ÙˆØ± ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù„Ùˆ Ø§Ù„Ø¬Ù„Ø³Ø© Ù†Ø´Ø·Ø©
if(localStorage.getItem('loggedUser')){
  let u=JSON.parse(localStorage.getItem('loggedUser'));
  if(u.role==="super"||u.role==="admin") location.href="admin.html";
  else if(u.role==="user") location.href="myPurchases.html";
}
</script>

</body>
</html>
