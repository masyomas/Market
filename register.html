<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ“ Ø§Ù„ØªØ³Ø¬ÙŠÙ„</title>
<style>
body { font-family:'Tahoma',sans-serif; background:#fff; margin:0; padding:0; text-align:center; direction:rtl;}
header { background:#6c757d; color:#fff; padding:15px; font-size:22px;}
nav { background:#6c757d; color:#fff; padding:8px; text-align:right;}
nav a { color:#fff; text-decoration:none; margin:0 5px; font-size:15px;}
nav a:hover { text-decoration:underline;}
main { margin:20px;}
input { padding:8px; margin:5px; font-size:15px; border:1px solid #ccc; border-radius:4px; width:220px;}
button { margin:5px; padding:6px 12px; font-size:14px; background:#6c757d; color:#fff; border:none; border-radius:4px; cursor:pointer;}
button:hover { background:#555;}
footer { background:#f1f1f1; text-align:center; padding:8px; font-size:13px; color:#777; border-top:1px solid #ddd;}
</style>
</head>
<body>

<header>ğŸ“ ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„</header>

<nav>
  <a href="index.html">ğŸ¬ Ø§Ù„Ù…ØªØ¬Ø±</a> |
  <a href="register.html">ğŸ“ Ø§Ù„ØªØ³Ø¬ÙŠÙ„</a> |
  <a href="myPurchases.html">ğŸ›’ Ù…Ø´ØªØ±ÙŠØ§ØªÙŠ</a> |
  <a href="admin.html">âš™ï¸ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</a>
</nav>

<main>
  <h3>ØªØ³Ø¬ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯</h3>
  <input type="text" id="fullName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ"><br/>
  <input type="text" id="phoneNumber" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (11 Ø±Ù‚Ù… ÙŠØ¨Ø¯Ø£ Ø¨Ù€0)"><br/>
  <input type="number" id="userCode" placeholder="Ø§Ù„ÙƒÙˆØ¯ (Ø¨ÙŠÙ† 2006â€“9998)"><br/>
  <button onclick="registerUser()">âœ… ØªØ³Ø¬ÙŠÙ„ Ø¬Ø¯ÙŠØ¯</button>

  <hr/>

  <h3>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</h3>
  <input type="text" id="loginPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ"><br/>
  <input type="number" id="loginCode" placeholder="Ø§Ù„ÙƒÙˆØ¯"><br/>
  <button onclick="loginUser()">ğŸš€ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„</button>
</main>

<footer>ğŸ’ Powered by Almasa ğŸ’</footer>

<script>
// ØªØ³Ø¬ÙŠÙ„ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
function registerUser(){
  let name = document.getElementById('fullName').value.trim();
  let phone = document.getElementById('phoneNumber').value.trim();
  let code = parseInt(document.getElementById('userCode').value.trim());
  let users = JSON.parse(localStorage.getItem('users') || "[]");

  // Ø§Ù„ØªØ­Ù‚Ù‚
  if(name.split(' ').length < 3){
    alert("âŒ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ ÙƒØ§Ù…Ù„Ù‹Ø§");
    return;
  }
  if(!/^[0][0-9]{10}$/.test(phone)){
    alert("âŒ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ø¨Ù€0 ÙˆÙŠØªÙƒÙˆÙ† Ù…Ù† 11 Ø±Ù‚Ù…");
    return;
  }
  if(isNaN(code) || code<2006 || code>9998){
    alert("âŒ Ø§Ù„ÙƒÙˆØ¯ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 2006 Ùˆ 9998");
    return;
  }
  if(users.find(u => u.phone === phone)){
    alert("âŒ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù…Ø³Ø¬Ù„ Ù…Ù† Ù‚Ø¨Ù„");
    return;
  }
  if(users.find(u => u.name === name)){
    alert("âŒ Ø§Ù„Ø§Ø³Ù… Ù…Ø³Ø¬Ù„ Ù…Ù† Ù‚Ø¨Ù„");
    return;
  }
  if(users.find(u => u.code == code)){
    alert("âŒ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„");
    return;
  }

  users.push({name, phone, code});
  localStorage.setItem('users', JSON.stringify(users));
  alert("âœ… ØªÙ… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!");
  document.getElementById('fullName').value="";
  document.getElementById('phoneNumber').value="";
  document.getElementById('userCode').value="";
}

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
function loginUser(){
  let phone = document.getElementById('loginPhone').value.trim();
  let code = document.getElementById('loginCode').value.trim();
  let users = JSON.parse(localStorage.getItem('users') || "[]");
  let found = users.find(u => u.phone === phone && u.code == code);
  if(found){
    sessionStorage.setItem('loggedUser', JSON.stringify(found));
    alert("âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„!");
    location.href = "myPurchases.html";
  } else {
    alert("âŒ Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©");
  }
}
</script>

</body>
</html>
