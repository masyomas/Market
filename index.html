<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ›ï¸ Ø§Ù„Ù…ØªØ¬Ø±</title>
<style>
body { font-family:'Tahoma',sans-serif; margin:0; padding:0; background:#fff; text-align:center;}
header { background:#6c757d; color:#fff; padding:12px; font-size:22px;}
nav { background:#f8f9fa; display:flex; justify-content:space-around; padding:8px 0; border-top:1px solid #ddd; border-bottom:1px solid #ddd; }
nav a { text-decoration:none; color:#333; font-size:14px;}
nav a:hover { color:#007bff; }
section { margin:10px auto; width:95%; max-width:600px;}
.product { border:1px solid #ddd; border-radius:6px; margin:10px 0; padding:10px; }
.product img { width:100%; max-height:200px; object-fit:cover; border-radius:4px;}
.product-details { text-align:right; margin:6px 0; font-size:14px;}
.buy-section { margin-top:6px; }
select.qty { padding:4px; font-size:14px; margin-left:5px;}
button.buyBtn { padding:4px 10px; font-size:14px; background:#28a745; color:#fff; border:none; border-radius:4px; cursor:pointer;}
button.buyBtn:hover { background:#1e7e34;}
footer { background:#f1f1f1; text-align:center; padding:8px; font-size:13px; color:#777; border-top:1px solid #ddd; margin-top:10px;}
</style>
</head>
<body>

<header>ğŸ›ï¸ Ø§Ù„Ù…ØªØ¬Ø±</header>

<nav>
  <a href="index.html">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
  <a href="mypurchases.html">ğŸ›’ Ù…Ø´ØªØ±ÙŠØ§ØªÙŠ</a>
  <a href="register.html">ğŸ”‘ Ø­Ø³Ø§Ø¨ÙŠ</a>
</nav>

<section id="productsContainer">
<!-- Ø³ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù‡Ù†Ø§ -->
</section>

<footer>ğŸ’ Powered by Almasa ğŸ’</footer>

<script>
// Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
let products = [
  {id:1, name:"Ø³Ù„Ø¹Ø© 1", price:100, image:"pictures/product1.jpg", desc:"ØªÙØ§ØµÙŠÙ„ Ù…Ø®ØªØµØ±Ø© Ø¹Ù† Ø§Ù„Ø³Ù„Ø¹Ø© 1"},
  {id:2, name:"Ø³Ù„Ø¹Ø© 2", price:150, image:"pictures/product2.jpg", desc:"ØªÙØ§ØµÙŠÙ„ Ù…Ø®ØªØµØ±Ø© Ø¹Ù† Ø§Ù„Ø³Ù„Ø¹Ø© 2"},
  {id:3, name:"Ø³Ù„Ø¹Ø© 3", price:200, image:"pictures/product3.jpg", desc:"ØªÙØ§ØµÙŠÙ„ Ù…Ø®ØªØµØ±Ø© Ø¹Ù† Ø§Ù„Ø³Ù„Ø¹Ø© 3"}
  // ØªÙ‚Ø¯Ø± ØªØ¶ÙŠÙ Ù…Ù†ØªØ¬Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù‡Ù†Ø§ Ø¨Ø³Ù‡ÙˆÙ„Ø©
];

// ØªÙˆÙ„ÙŠØ¯ HTML Ù„ÙƒÙ„ Ù…Ù†ØªØ¬
let html = "";
products.forEach(prod=>{
  html+=`
  <div class="product">
    <img src="${prod.image}" alt="${prod.name}">
    <div class="product-details">
      <div><b>${prod.name}</b></div>
      <div>Ø§Ù„Ø³Ø¹Ø±: ${prod.price} Ø¬Ù†ÙŠÙ‡</div>
      <div>${prod.desc}</div>
    </div>
    <div class="buy-section">
      <select class="qty" id="qty_${prod.id}">
        ${[...Array(9)].map((_,i)=>`<option>${i+1}</option>`).join('')}
      </select>
      <button class="buyBtn" onclick="buyProduct('${prod.name}','${prod.price}','${prod.image}','qty_${prod.id}')">Ø´Ø±Ø§Ø¡</button>
    </div>
  </div>`;
});
document.getElementById('productsContainer').innerHTML=html;

// Ø¯Ø§Ù„Ø© Ø§Ù„Ø´Ø±Ø§Ø¡
function buyProduct(name,price,image,qtySelectId){
  let logged=JSON.parse(localStorage.getItem('loggedUser'));
  if(!logged || logged.role!=="user") {
    alert("âš ï¸ ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹.");
    location.href="register.html";
    return;
  }
  let qty= parseInt(document.getElementById(qtySelectId).value) || 1;
  let purchases=JSON.parse(localStorage.getItem('purchases')||"[]");
  for(let i=0;i<qty;i++){
    purchases.push({
      phone: logged.phone,
      name: name,
      price: price,
      image: image,
      timestamp: Date.now()+i // ØªÙØ§Ø¯ÙŠ Ù†ÙØ³ Ø§Ù„ØªÙˆÙ‚ÙŠØª
    });
  }
  localStorage.setItem('purchases', JSON.stringify(purchases));
  alert(`âœ… ØªÙ… Ø´Ø±Ø§Ø¡ ${qty} Ù‚Ø·Ø¹Ø© Ù…Ù† ${name}`);
}
</script>

</body>
</html>
